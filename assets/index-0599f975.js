import{d as g,o as u,e as v,f as e,t as r,g as f,u as c,i as _,I as O,k as P,a as p,X as M,F as y,Y as V,Z as w,l as h,w as $,J as R,$ as S,W as A,c as I,a0 as C,h as K}from"./index-bbbf8229.js";import{t as L,o as x,f as D,_ as F}from"./textAdaptation-fe59682a.js";import{_ as k}from"./RangeBar.vue_vue_type_script_setup_true_lang-c2cf99b9.js";const H={class:"rounded-lg border border-base-300"},X={class:"table w-full"},Y={class:"w-40 p-3 font-semibold",rowspan:"2"},Q={class:"p-3"},J={class:"p-3"},z={class:"p-3"},W={class:"p-3"},Z={class:"w-40 border-b-0 bg-transparent p-3 font-semibold",rowspan:"2"},j={class:"p-3"},q={class:"p-3"},ee={class:"p-3"},te={class:"p-3"},se=g({__name:"ReadingToolsForm",props:{maskThickness:null,maskOpacity:null,rulerThickness:null,rulerOpacity:null},emits:["undefined","update:rulerThickness","update:maskOpacity","update:rulerOpacity"],setup(a,{emit:t}){return(n,s)=>(u(),v("div",H,[e("table",X,[e("tbody",null,[e("tr",null,[e("td",Y,r(n.$t("QUICK_ACTIVATE.SCREEN_MASK")),1),e("td",Q,r(n.$t("QUICK_ACTIVATE.THICKNESS")),1),e("td",J,[f(k,{"model-value":a.maskThickness,options:c(L),"onUpdate:modelValue":s[0]||(s[0]=o=>t("update:maskThickness",o))},null,8,["model-value","options"])])]),e("tr",null,[e("td",z,r(n.$t("QUICK_ACTIVATE.OPACITY")),1),e("td",W,[f(k,{"model-value":a.maskOpacity,options:c(x),"onUpdate:modelValue":s[1]||(s[1]=o=>t("update:maskOpacity",o))},null,8,["model-value","options"])])]),e("tr",null,[e("td",Z,r(n.$t("QUICK_ACTIVATE.READING_RULER")),1),e("td",j,r(n.$t("QUICK_ACTIVATE.THICKNESS")),1),e("td",q,[f(k,{"model-value":a.rulerThickness,options:c(L),"onUpdate:modelValue":s[2]||(s[2]=o=>t("update:rulerThickness",o))},null,8,["model-value","options"])])]),e("tr",null,[e("td",ee,r(n.$t("QUICK_ACTIVATE.OPACITY")),1),e("td",te,[f(k,{"model-value":a.rulerOpacity,options:c(x),"onUpdate:modelValue":s[3]||(s[3]=o=>t("update:rulerOpacity",o))},null,8,["model-value","options"])])])])])]))}});function G(){const a=_(0),t=n=>a.value=n.clientY;return O(()=>{document.addEventListener("mousemove",t)}),P(()=>{document.removeEventListener("mousemove",t)}),{clientY:a}}const oe={class:"ruler__line fixed inset-x-0 top-0 bg-black print:hidden"},ne=g({__name:"ReadingToolsRuler",props:{ruler:null},setup(a){const t=a;M(l=>({"35f79210":c(d),"1d85f649":c(s),"392b4c24":c(o)}));const{clientY:n}=G(),s=p(()=>`${n.value}px`),o=p(()=>"#000000"+t.ruler.opacity),d=p(()=>`${t.ruler.thickness}px`);return console.log(t),(l,i)=>(u(),v("div",oe))}});const N=(a,t)=>{const n=a.__vccOpts||a;for(const[s,o]of t)n[s]=o;return n},ae=N(ne,[["__scopeId","data-v-e395992c"]]),U=a=>(V("data-v-f2817bde"),a=a(),w(),a),le=U(()=>e("div",{class:"mask__top fixed inset-0 print:hidden"},null,-1)),ie=U(()=>e("div",{class:"mask__bottom top-50 fixed inset-0 print:hidden"},null,-1)),re=g({__name:"ReadingToolsMask",props:{mask:null},setup(a){const t=a;M(i=>({"93df31a4":c(n),"4ef434d2":c(l),"48bd3f56":c(o)}));const n=p(()=>"#000000"+t.mask.opacity),s=p(()=>25*parseInt(t.mask.thickness)),o=p(()=>`${s.value}px`),{clientY:d}=G(),l=p(()=>`${d.value-Math.floor(s.value/2)}px`);return(i,T)=>(u(),v(y,null,[le,ie],64))}});const ce=N(re,[["__scopeId","data-v-f2817bde"]]),de=g({__name:"PrintButton",setup(a){const t=_(),n=p(()=>t.value!==Office.PlatformType.Mac);O(()=>{Office.onReady(o=>{t.value=o.platform})});const s=()=>window.print();return(o,d)=>c(n)?(u(),v("button",{key:0,class:"btn-outline btn-secondary btn-xs btn",onClick:s},r(o.$t("DIALOG_BOX.PRINT")),1)):h("",!0)}}),ue={class:"sticky top-0 z-10 flex items-center gap-4 bg-white py-2 px-4 print:hidden"},_e={class:"flex cursor-pointer items-center"},pe={class:"flex cursor-pointer items-center"},me={for:"reading-tools-form-modal",class:"btn-outline btn-xs btn"},fe=e("input",{id:"reading-tools-form-modal",type:"checkbox",class:"modal-toggle"},null,-1),ve={for:"reading-tools-form-modal",class:"modal cursor-pointer"},ge={class:"modal-box relative",for:""},he=e("label",{for:"reading-tools-form-modal",class:"btn-sm btn-circle btn absolute right-2 top-2"},"✕",-1),ke=g({__name:"ReadingTools",setup(a){const t=_(C()),n=_(C()),s=_(!1),o=_(!1);return $(s,()=>{s.value&&(o.value=!1)}),$(o,()=>{o.value&&(s.value=!1)}),(d,l)=>(u(),v(y,null,[e("div",ue,[e("label",_e,[R(e("input",{"onUpdate:modelValue":l[0]||(l[0]=i=>s.value=i),type:"checkbox",class:"toggle toggle-sm mr-1"},null,512),[[S,s.value]]),A(" "+r(d.$t("DIALOG_BOX.MASK")),1)]),e("label",pe,[R(e("input",{"onUpdate:modelValue":l[1]||(l[1]=i=>o.value=i),type:"checkbox",class:"toggle toggle-sm mr-1"},null,512),[[S,o.value]]),A(" "+r(d.$t("DIALOG_BOX.RULER")),1)]),e("label",me,r(d.$t("SETTINGS.MY_PREFERENCES")),1),fe,e("label",ve,[e("label",ge,[he,f(se,{"mask-opacity":t.value.opacity,"onUpdate:mask-opacity":l[2]||(l[2]=i=>t.value.opacity=i),"mask-thickness":t.value.thickness,"onUpdate:mask-thickness":l[3]||(l[3]=i=>t.value.thickness=i),"ruler-opacity":n.value.opacity,"onUpdate:ruler-opacity":l[4]||(l[4]=i=>n.value.opacity=i),"ruler-thickness":n.value.thickness,"onUpdate:ruler-thickness":l[5]||(l[5]=i=>n.value.thickness=i),class:"mt-6"},null,8,["mask-opacity","mask-thickness","ruler-opacity","ruler-thickness"])])]),f(de,{class:"ml-auto"})]),s.value?(u(),I(ce,{key:0,mask:t.value},null,8,["mask"])):h("",!0),o.value?(u(),I(ae,{key:1,ruler:n.value},null,8,["ruler"])):h("",!0)],64))}}),be={key:0,class:"alert relative m-4 block w-auto shadow-lg"},Ae={class:"text-lg font-semibold"},Ie={class:"p-1 text-sm"},Oe={class:"p-1 text-sm"},ye=["href"],Te=g({__name:"FloatingImagesAlert",setup(a){const t=_(!0),n=()=>t.value=!1;return(s,o)=>t.value?(u(),v("div",be,[e("div",{class:"btn-sm btn-circle btn absolute right-2 top-2",onClick:n},"✕"),e("div",Ae,r(s.$t("DIALOG_BOX.FLOATING_IMAGES_TITLE")),1),e("div",Ie,r(s.$t("DIALOG_BOX.FLOATING_IMAGES_EXPLANATION")),1),e("div",Oe,[A(r(s.$t("DIALOG_BOX.FLOATING_IMAGES_LEARN_MORE"))+" ",1),e("a",{class:"link",target:"_blank",href:s.$t("DIALOG_BOX.FLOATING_IMAGES_SUPPORT_LINK")},r(s.$t("DIALOG_BOX.FLOATING_IMAGES_CLICK_HERE")),9,ye)])])):h("",!0)}}),Ee={class:"py-2 px-4"},$e={key:0},Le=g({__name:"AdaptedContentPage",setup(a){const t=_(""),{getActiveProfile:n}=K(),s=p(()=>{var m;return(m=n())==null?void 0:m.settings}),o=_(""),d=_(!1),l=m=>{try{const b=m.message,{html:B,withFloatingImages:E}=JSON.parse(b);o.value=B,d.value=E,console.log("withFloatingImages",E)}catch{t.value="error"}},i=()=>{Office.context.ui.messageParent("ready",{targetOrigin:"*"})},T=m=>{i(),m.status!==Office.AsyncResultStatus.Succeeded&&(t.value=m.error.message)};return O(()=>{Office.onReady(()=>{Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,l,T)})}),(m,b)=>(u(),v(y,null,[f(c(ke)),e("div",Ee,[t.value?(u(),v("div",$e,r(t.value),1)):h("",!0),d.value?(u(),I(Te,{key:1})):h("",!0),f(F,{"adapt-html-element-async":c(D)(),settings:c(s),"content-to-adapt":o.value},null,8,["adapt-html-element-async","settings","content-to-adapt"])])],64))}});export{Le as AdaptedContentPage};
