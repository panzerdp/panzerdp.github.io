import{d as g,h as P,o as d,e as p,F as I,r as H,t as i,u as c,i as _,f as t,W as b,l as h,g as f,I as T,k as X,a as v,X as U,Y,Z as Q,w as R,O as C,J as S,$ as L,a0 as x,c as A,a1 as M,C as V}from"./index-fb9bb56f.js";import{t as G,o as N,f as J,_ as z}from"./textAdaptation-1dfd1c85.js";import{_ as O}from"./RangeBar.vue_vue_type_script_setup_true_lang-d5a52c69.js";const W=["value"],Z=["value"],j=g({__name:"TextProfileActiveDropdownReadonly",props:{modelValue:null},emits:["update:modelValue"],setup(a,{emit:e}){const{preferences:o}=P(),s=n=>{const{value:u}=n.target;e("update:modelValue",Number(u))};return(n,u)=>(d(),p("select",{value:a.modelValue,class:"select-primary select select-sm",onChange:s},[(d(!0),p(I,null,H(c(o).profiles,({name:r,id:l})=>(d(),p("option",{key:l,value:l},i(r),9,Z))),128))],40,W))}}),q={key:0,class:"alert relative m-4 block w-auto shadow-lg"},ee={class:"text-lg font-semibold"},te={class:"p-1 text-sm"},se={class:"p-1 text-sm"},oe=["href"],ne=g({__name:"FloatingImagesAlert",setup(a){const e=_(!0),o=()=>e.value=!1;return(s,n)=>e.value?(d(),p("div",q,[t("div",{class:"btn-sm btn-circle btn absolute right-2 top-2",onClick:o},"✕"),t("div",ee,i(s.$t("DIALOG_BOX.FLOATING_IMAGES_TITLE")),1),t("div",te,i(s.$t("DIALOG_BOX.FLOATING_IMAGES_EXPLANATION")),1),t("div",se,[b(i(s.$t("DIALOG_BOX.FLOATING_IMAGES_LEARN_MORE"))+" ",1),t("a",{class:"link",target:"_blank",href:s.$t("DIALOG_BOX.FLOATING_IMAGES_SUPPORT_LINK")},i(s.$t("DIALOG_BOX.FLOATING_IMAGES_CLICK_HERE")),9,oe)])])):h("",!0)}}),ae={for:"reading-tools-form-modal",class:"btn-outline btn-xs btn"},le=t("input",{id:"reading-tools-form-modal",type:"checkbox",class:"modal-toggle"},null,-1),re={for:"reading-tools-form-modal",class:"modal cursor-pointer"},ce={class:"modal-box relative",for:""},ie=t("label",{for:"reading-tools-form-modal",class:"btn-sm btn-circle btn absolute right-2 top-2"},"✕",-1),ue={class:"mt-6 rounded-lg border border-base-300"},de={class:"table w-full"},_e={class:"w-40 p-3 font-semibold",rowspan:"2"},pe={class:"p-3"},me={class:"p-3"},fe={class:"p-3"},ve={class:"p-3"},ge={class:"w-40 border-b-0 bg-transparent p-3 font-semibold",rowspan:"2"},he={class:"p-3"},ke={class:"p-3"},be={class:"p-3"},Ie={class:"p-3"},Oe=g({__name:"ReadingToolsFormModal",props:{maskThickness:null,maskOpacity:null,rulerThickness:null,rulerOpacity:null},emits:["undefined","update:rulerThickness","update:maskOpacity","update:rulerOpacity"],setup(a,{emit:e}){return(o,s)=>(d(),p(I,null,[t("label",ae,i(o.$t("SETTINGS.MY_PREFERENCES")),1),le,t("label",re,[t("label",ce,[ie,t("div",ue,[t("table",de,[t("tbody",null,[t("tr",null,[t("td",_e,i(o.$t("QUICK_ACTIVATE.SCREEN_MASK")),1),t("td",pe,i(o.$t("QUICK_ACTIVATE.THICKNESS")),1),t("td",me,[f(O,{"model-value":a.maskThickness,options:c(G),"onUpdate:modelValue":s[0]||(s[0]=n=>e("update:maskThickness",n))},null,8,["model-value","options"])])]),t("tr",null,[t("td",fe,i(o.$t("QUICK_ACTIVATE.OPACITY")),1),t("td",ve,[f(O,{"model-value":a.maskOpacity,options:c(N),"onUpdate:modelValue":s[1]||(s[1]=n=>e("update:maskOpacity",n))},null,8,["model-value","options"])])]),t("tr",null,[t("td",ge,i(o.$t("QUICK_ACTIVATE.READING_RULER")),1),t("td",he,i(o.$t("QUICK_ACTIVATE.THICKNESS")),1),t("td",ke,[f(O,{"model-value":a.rulerThickness,options:c(G),"onUpdate:modelValue":s[2]||(s[2]=n=>e("update:rulerThickness",n))},null,8,["model-value","options"])])]),t("tr",null,[t("td",be,i(o.$t("QUICK_ACTIVATE.OPACITY")),1),t("td",Ie,[f(O,{"model-value":a.rulerOpacity,options:c(N),"onUpdate:modelValue":s[3]||(s[3]=n=>e("update:rulerOpacity",n))},null,8,["model-value","options"])])])])])])])])],64))}});function B(){const a=_(0),e=o=>a.value=o.clientY;return T(()=>{document.addEventListener("mousemove",e)}),X(()=>{document.removeEventListener("mousemove",e)}),{clientY:a}}const ye={class:"ruler__line fixed inset-x-0 top-0 bg-black print:hidden"},Ae=g({__name:"ReadingToolsRuler",props:{ruler:null},setup(a){const e=a;U(r=>({ccf5bf72:c(u),"5c2c2098":c(s),"616b2896":c(n)}));const{clientY:o}=B(),s=v(()=>`${o.value}px`),n=v(()=>"#000000"+e.ruler.opacity),u=v(()=>`${e.ruler.thickness}px`);return console.log(e),(r,l)=>(d(),p("div",ye))}});const w=(a,e)=>{const o=a.__vccOpts||a;for(const[s,n]of e)o[s]=n;return o},Te=w(Ae,[["__scopeId","data-v-84cc20b2"]]),D=a=>(Y("data-v-f221fa5c"),a=a(),Q(),a),Ee=D(()=>t("div",{class:"mask__top fixed inset-0 print:hidden"},null,-1)),$e=D(()=>t("div",{class:"mask__bottom top-50 fixed inset-0 print:hidden"},null,-1)),Re=g({__name:"ReadingToolsMask",props:{mask:null},setup(a){const e=a;U(l=>({"54458eea":c(o),"09518556":c(r),"5f82e6ce":c(n)}));const o=v(()=>"#000000"+e.mask.opacity),s=v(()=>25*parseInt(e.mask.thickness)),n=v(()=>`${s.value}px`),{clientY:u}=B(),r=v(()=>`${u.value-Math.floor(s.value/2)}px`);return(l,E)=>(d(),p(I,null,[Ee,$e],64))}});const Ce=w(Re,[["__scopeId","data-v-f221fa5c"]]);function Se(){const a=_(!1),e=_(!1);return R(a,()=>{a.value&&(e.value=!1)}),R(e,()=>{e.value&&(a.value=!1)}),{maskEnabled:a,rulerEnabled:e}}const Le={class:"sticky top-0 z-10 flex items-center gap-4 bg-white py-2 px-4 print:hidden"},xe={class:"flex cursor-pointer items-center"},Me={class:"flex cursor-pointer items-center"},Ve=g({__name:"ReadingToolsToolbar",setup(a){const e=_(M()),o=_(M()),{maskEnabled:s,rulerEnabled:n}=Se();return(u,r)=>(d(),p(I,null,[t("div",Le,[C(u.$slots,"before"),t("label",xe,[S(t("input",{"onUpdate:modelValue":r[0]||(r[0]=l=>x(s)?s.value=l:null),type:"checkbox",class:"toggle toggle-sm mr-1"},null,512),[[L,c(s)]]),b(" "+i(u.$t("DIALOG_BOX.MASK")),1)]),t("label",Me,[S(t("input",{"onUpdate:modelValue":r[1]||(r[1]=l=>x(n)?n.value=l:null),type:"checkbox",class:"toggle toggle-sm mr-1"},null,512),[[L,c(n)]]),b(" "+i(u.$t("DIALOG_BOX.RULER")),1)]),f(Oe,{"mask-opacity":e.value.opacity,"onUpdate:mask-opacity":r[2]||(r[2]=l=>e.value.opacity=l),"mask-thickness":e.value.thickness,"onUpdate:mask-thickness":r[3]||(r[3]=l=>e.value.thickness=l),"ruler-opacity":o.value.opacity,"onUpdate:ruler-opacity":r[4]||(r[4]=l=>o.value.opacity=l),"ruler-thickness":o.value.thickness,"onUpdate:ruler-thickness":r[5]||(r[5]=l=>o.value.thickness=l)},null,8,["mask-opacity","mask-thickness","ruler-opacity","ruler-thickness"]),C(u.$slots,"after")]),c(s)?(d(),A(Ce,{key:0,mask:e.value},null,8,["mask"])):h("",!0),c(n)?(d(),A(Te,{key:1,ruler:o.value},null,8,["ruler"])):h("",!0)],64))}}),Ge=g({__name:"PrintButton",setup(a){const e=_(),o=v(()=>e.value!==Office.PlatformType.Mac);T(()=>{Office.onReady(n=>{e.value=n.platform})});const s=()=>window.print();return(n,u)=>c(o)?(d(),p("button",{key:0,class:"btn-outline btn-secondary btn-xs btn",onClick:s},i(n.$t("DIALOG_BOX.PRINT")),1)):h("",!0)}}),Ne={class:"py-2 px-4"},Pe={key:0},De=g({__name:"AdaptedContentPage",setup(a){const e=_(""),{preferences:o,getProfileById:s}=P(),n=_(o.activeProfileId),u=v(()=>{var m;return(m=s(n.value))==null?void 0:m.settings}),r=_(""),l=_(!1),E=m=>{try{const k=m.message,{html:y,withFloatingImages:$}=JSON.parse(k);r.value=y,l.value=$,console.log("withFloatingImages",$)}catch{e.value="error"}},K=()=>{Office.context.ui.messageParent("ready",{targetOrigin:"*"})},F=m=>{K(),m.status!==Office.AsyncResultStatus.Succeeded&&(e.value=m.error.message)};return T(()=>{Office.onReady(()=>{Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,E,F)})}),(m,k)=>(d(),p(I,null,[f(c(Ve),null,{before:V(()=>[t("div",null,[b(i(m.$t("DIALOG_BOX.PROFILE"))+" ",1),f(c(j),{modelValue:n.value,"onUpdate:modelValue":k[0]||(k[0]=y=>n.value=y),class:"select-secondary ml-1 w-52"},null,8,["modelValue"])]),b(" | ")]),after:V(()=>[f(Ge)]),_:1}),t("div",Ne,[e.value?(d(),p("div",Pe,i(e.value),1)):h("",!0),l.value?(d(),A(ne,{key:1})):h("",!0),f(z,{"adapt-html-element-async":c(J)(),settings:c(u),"content-to-adapt":r.value},null,8,["adapt-html-element-async","settings","content-to-adapt"])])],64))}});export{De as AdaptedContentPage};
