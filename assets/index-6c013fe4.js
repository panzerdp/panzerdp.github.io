import{d as g,o as d,e as v,f as e,t as i,g as f,u as r,i as _,I as O,k as P,a as p,X as M,F as y,Y as V,Z as w,l as k,w as $,J as R,$ as S,W as A,c as I,a0 as C,h as K}from"./index-2c644d31.js";import{t as L,o as x,f as D,_ as F}from"./textAdaptation-207ec773.js";import{_ as h}from"./RangeBar.vue_vue_type_script_setup_true_lang-0bbdb620.js";const H={class:"rounded-lg border border-base-300"},X={class:"table w-full"},Y={class:"w-40 p-3 font-semibold",rowspan:"2"},Q={class:"p-3"},J={class:"p-3"},z={class:"p-3"},W={class:"p-3"},Z={class:"w-40 border-b-0 bg-transparent p-3 font-semibold",rowspan:"2"},j={class:"p-3"},q={class:"p-3"},ee={class:"p-3"},te={class:"p-3"},se=g({__name:"ReadingToolsForm",props:{maskThickness:null,maskOpacity:null,rulerThickness:null,rulerOpacity:null},emits:["undefined","update:rulerThickness","update:maskOpacity","update:rulerOpacity"],setup(n,{emit:t}){return(a,s)=>(d(),v("div",H,[e("table",X,[e("tbody",null,[e("tr",null,[e("td",Y,i(a.$t("QUICK_ACTIVATE.SCREEN_MASK")),1),e("td",Q,i(a.$t("QUICK_ACTIVATE.THICKNESS")),1),e("td",J,[f(h,{"model-value":n.maskThickness,options:r(L),"onUpdate:modelValue":s[0]||(s[0]=o=>t("update:maskThickness",o))},null,8,["model-value","options"])])]),e("tr",null,[e("td",z,i(a.$t("QUICK_ACTIVATE.OPACITY")),1),e("td",W,[f(h,{"model-value":n.maskOpacity,options:r(x),"onUpdate:modelValue":s[1]||(s[1]=o=>t("update:maskOpacity",o))},null,8,["model-value","options"])])]),e("tr",null,[e("td",Z,i(a.$t("QUICK_ACTIVATE.READING_RULER")),1),e("td",j,i(a.$t("QUICK_ACTIVATE.THICKNESS")),1),e("td",q,[f(h,{"model-value":n.rulerThickness,options:r(L),"onUpdate:modelValue":s[2]||(s[2]=o=>t("update:rulerThickness",o))},null,8,["model-value","options"])])]),e("tr",null,[e("td",ee,i(a.$t("QUICK_ACTIVATE.OPACITY")),1),e("td",te,[f(h,{"model-value":n.rulerOpacity,options:r(x),"onUpdate:modelValue":s[3]||(s[3]=o=>t("update:rulerOpacity",o))},null,8,["model-value","options"])])])])])]))}});function G(){const n=_(0),t=a=>n.value=a.clientY;return O(()=>{document.addEventListener("mousemove",t)}),P(()=>{document.removeEventListener("mousemove",t)}),{clientY:n}}const oe={class:"ruler__line fixed inset-x-0 top-0 bg-black"},ae=g({__name:"ReadingToolsRuler",props:{ruler:null},setup(n){const t=n;M(l=>({"24a159b6":r(u),dca909f2:r(s),"49b65f26":r(o)}));const{clientY:a}=G(),s=p(()=>`${a.value}px`),o=p(()=>"#000000"+t.ruler.opacity),u=p(()=>`${t.ruler.thickness}px`);return console.log(t),(l,c)=>(d(),v("div",oe))}});const N=(n,t)=>{const a=n.__vccOpts||n;for(const[s,o]of t)a[s]=o;return a},ne=N(ae,[["__scopeId","data-v-12bd05e6"]]),U=n=>(V("data-v-40ff5a6b"),n=n(),w(),n),le=U(()=>e("div",{class:"mask__top fixed inset-0"},null,-1)),ce=U(()=>e("div",{class:"mask__bottom top-50 fixed inset-0"},null,-1)),ie=g({__name:"ReadingToolsMask",props:{mask:null},setup(n){const t=n;M(c=>({"3f9f42aa":r(a),ce267996:r(l),"373c0a79":r(o)}));const a=p(()=>"#000000"+t.mask.opacity),s=p(()=>25*parseInt(t.mask.thickness)),o=p(()=>`${s.value}px`),{clientY:u}=G(),l=p(()=>`${u.value-Math.floor(s.value/2)}px`);return(c,T)=>(d(),v(y,null,[le,ce],64))}});const re=N(ie,[["__scopeId","data-v-40ff5a6b"]]),ue=g({__name:"PrintButton",setup(n){const t=_(),a=p(()=>t.value!==Office.PlatformType.Mac);O(()=>{Office.onReady(o=>{t.value=o.platform})});const s=()=>window.print();return(o,u)=>r(a)?(d(),v("button",{key:0,class:"btn-outline btn-secondary btn-xs btn",onClick:s},i(o.$t("DIALOG_BOX.PRINT")),1)):k("",!0)}}),de={class:"sticky top-0 z-10 flex items-center gap-4 bg-white py-2 px-4 print:hidden"},_e={class:"flex cursor-pointer items-center"},pe={class:"flex cursor-pointer items-center"},me={for:"reading-tools-form-modal",class:"btn-outline btn-xs btn"},fe=e("input",{id:"reading-tools-form-modal",type:"checkbox",class:"modal-toggle"},null,-1),ve={class:"modal"},ge={class:"modal-box relative"},ke=e("label",{for:"reading-tools-form-modal",class:"btn-sm btn-circle btn absolute right-2 top-2"},"✕",-1),he=g({__name:"ReadingTools",setup(n){const t=_(C()),a=_(C()),s=_(!1),o=_(!1);return $(s,()=>{s.value&&(o.value=!1)}),$(o,()=>{o.value&&(s.value=!1)}),(u,l)=>(d(),v(y,null,[e("div",de,[e("label",_e,[R(e("input",{"onUpdate:modelValue":l[0]||(l[0]=c=>s.value=c),type:"checkbox",class:"toggle toggle-sm mr-1"},null,512),[[S,s.value]]),A(" "+i(u.$t("DIALOG_BOX.MASK")),1)]),e("label",pe,[R(e("input",{"onUpdate:modelValue":l[1]||(l[1]=c=>o.value=c),type:"checkbox",class:"toggle toggle-sm mr-1"},null,512),[[S,o.value]]),A(" "+i(u.$t("DIALOG_BOX.RULER")),1)]),e("label",me,i(u.$t("SETTINGS.MY_PREFERENCES")),1),fe,e("div",ve,[e("div",ge,[ke,f(se,{"mask-opacity":t.value.opacity,"onUpdate:mask-opacity":l[2]||(l[2]=c=>t.value.opacity=c),"mask-thickness":t.value.thickness,"onUpdate:mask-thickness":l[3]||(l[3]=c=>t.value.thickness=c),"ruler-opacity":a.value.opacity,"onUpdate:ruler-opacity":l[4]||(l[4]=c=>a.value.opacity=c),"ruler-thickness":a.value.thickness,"onUpdate:ruler-thickness":l[5]||(l[5]=c=>a.value.thickness=c),class:"mt-6"},null,8,["mask-opacity","mask-thickness","ruler-opacity","ruler-thickness"])])]),f(ue,{class:"ml-auto"})]),s.value?(d(),I(re,{key:0,mask:t.value},null,8,["mask"])):k("",!0),o.value?(d(),I(ne,{key:1,ruler:a.value},null,8,["ruler"])):k("",!0)],64))}}),be={key:0,class:"alert relative m-4 block w-auto shadow-lg"},Ae={class:"text-lg font-semibold"},Ie={class:"p-1 text-sm"},Oe={class:"p-1 text-sm"},ye=["href"],Te=g({__name:"FloatingImagesAlert",setup(n){const t=_(!0),a=()=>t.value=!1;return(s,o)=>t.value?(d(),v("div",be,[e("div",{class:"btn-sm btn-circle btn absolute right-2 top-2",onClick:a},"✕"),e("div",Ae,i(s.$t("DIALOG_BOX.FLOATING_IMAGES_TITLE")),1),e("div",Ie,i(s.$t("DIALOG_BOX.FLOATING_IMAGES_EXPLANATION")),1),e("div",Oe,[A(i(s.$t("DIALOG_BOX.FLOATING_IMAGES_LEARN_MORE"))+" ",1),e("a",{class:"link",target:"_blank",href:s.$t("DIALOG_BOX.FLOATING_IMAGES_SUPPORT_LINK")},i(s.$t("DIALOG_BOX.FLOATING_IMAGES_CLICK_HERE")),9,ye)])])):k("",!0)}}),Ee={class:"py-2 px-4"},$e={key:0},Le=g({__name:"AdaptedContentPage",setup(n){const t=_(""),{getActiveProfile:a}=K(),s=p(()=>{var m;return(m=a())==null?void 0:m.settings}),o=_(""),u=_(!1),l=m=>{try{const b=m.message,{html:B,withFloatingImages:E}=JSON.parse(b);o.value=B,u.value=E,console.log("withFloatingImages",E)}catch{t.value="error"}},c=()=>{Office.context.ui.messageParent("ready",{targetOrigin:"*"})},T=m=>{c(),m.status!==Office.AsyncResultStatus.Succeeded&&(t.value=m.error.message)};return O(()=>{Office.onReady(()=>{Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,l,T)})}),(m,b)=>(d(),v(y,null,[f(r(he)),e("div",Ee,[t.value?(d(),v("div",$e,i(t.value),1)):k("",!0),u.value?(d(),I(Te,{key:1})):k("",!0),f(F,{"adapt-html-element-async":r(D)(),settings:r(s),"content-to-adapt":o.value},null,8,["adapt-html-element-async","settings","content-to-adapt"])])],64))}});export{Le as AdaptedContentPage};
