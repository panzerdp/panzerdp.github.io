import{d as g,o as u,e as v,f as t,t as i,g as f,u as r,i as _,I as O,k as P,a as p,X as M,F as y,Y as V,Z as w,w as $,J as R,$ as C,W as A,c as I,l as k,a0 as S,h as K}from"./index-ce71edb9.js";import{t as L,o as x,f as D,_ as F}from"./textAdaptation-77239534.js";import{_ as h}from"./RangeBar.vue_vue_type_script_setup_true_lang-de47bd1d.js";const H={class:"rounded-lg border border-base-300"},X={class:"table w-full"},Y={class:"w-40 p-3 font-semibold",rowspan:"2"},Q={class:"p-3"},J={class:"p-3"},z={class:"p-3"},W={class:"p-3"},Z={class:"w-40 border-b-0 bg-transparent p-3 font-semibold",rowspan:"2"},j={class:"p-3"},q={class:"p-3"},ee={class:"p-3"},te={class:"p-3"},se=g({__name:"ReadingToolsForm",props:{maskThickness:null,maskOpacity:null,rulerThickness:null,rulerOpacity:null},emits:["undefined","update:rulerThickness","update:maskOpacity","update:rulerOpacity"],setup(n,{emit:s}){return(o,e)=>(u(),v("div",H,[t("table",X,[t("tbody",null,[t("tr",null,[t("td",Y,i(o.$t("QUICK_ACTIVATE.SCREEN_MASK")),1),t("td",Q,i(o.$t("QUICK_ACTIVATE.THICKNESS")),1),t("td",J,[f(h,{"model-value":n.maskThickness,options:r(L),"onUpdate:modelValue":e[0]||(e[0]=a=>s("update:maskThickness",a))},null,8,["model-value","options"])])]),t("tr",null,[t("td",z,i(o.$t("QUICK_ACTIVATE.OPACITY")),1),t("td",W,[f(h,{"model-value":n.maskOpacity,options:r(x),"onUpdate:modelValue":e[1]||(e[1]=a=>s("update:maskOpacity",a))},null,8,["model-value","options"])])]),t("tr",null,[t("td",Z,i(o.$t("QUICK_ACTIVATE.READING_RULER")),1),t("td",j,i(o.$t("QUICK_ACTIVATE.THICKNESS")),1),t("td",q,[f(h,{"model-value":n.rulerThickness,options:r(L),"onUpdate:modelValue":e[2]||(e[2]=a=>s("update:rulerThickness",a))},null,8,["model-value","options"])])]),t("tr",null,[t("td",ee,i(o.$t("QUICK_ACTIVATE.OPACITY")),1),t("td",te,[f(h,{"model-value":n.rulerOpacity,options:r(x),"onUpdate:modelValue":e[3]||(e[3]=a=>s("update:rulerOpacity",a))},null,8,["model-value","options"])])])])])]))}});function G(){const n=_(0),s=o=>n.value=o.clientY;return O(()=>{document.addEventListener("mousemove",s)}),P(()=>{document.removeEventListener("mousemove",s)}),{clientY:n}}const oe={class:"ruler__line fixed inset-x-0 top-0 bg-black"},ae=g({__name:"ReadingToolsRuler",props:{ruler:null},setup(n){const s=n;M(l=>({"24a159b6":r(d),dca909f2:r(e),"49b65f26":r(a)}));const{clientY:o}=G(),e=p(()=>`${o.value}px`),a=p(()=>"#000000"+s.ruler.opacity),d=p(()=>`${s.ruler.thickness}px`);return console.log(s),(l,c)=>(u(),v("div",oe))}});const U=(n,s)=>{const o=n.__vccOpts||n;for(const[e,a]of s)o[e]=a;return o},ne=U(ae,[["__scopeId","data-v-12bd05e6"]]),N=n=>(V("data-v-40ff5a6b"),n=n(),w(),n),le=N(()=>t("div",{class:"mask__top fixed inset-0"},null,-1)),ce=N(()=>t("div",{class:"mask__bottom top-50 fixed inset-0"},null,-1)),ie=g({__name:"ReadingToolsMask",props:{mask:null},setup(n){const s=n;M(c=>({"3f9f42aa":r(o),ce267996:r(l),"373c0a79":r(a)}));const o=p(()=>"#000000"+s.mask.opacity),e=p(()=>25*parseInt(s.mask.thickness)),a=p(()=>`${e.value}px`),{clientY:d}=G(),l=p(()=>`${d.value-Math.floor(e.value/2)}px`);return(c,T)=>(u(),v(y,null,[le,ce],64))}});const re=U(ie,[["__scopeId","data-v-40ff5a6b"]]),ue=g({__name:"PrintButton",setup(n){const s=_();p(()=>s.value!==Office.PlatformType.Mac),O(()=>{Office.onReady(e=>{s.value=e.platform})});const o=()=>window.print();return(e,a)=>(u(),v("button",{class:"btn-outline btn-secondary btn-xs btn",onClick:o},i(e.$t("DIALOG_BOX.PRINT")),1))}}),de={class:"sticky top-0 z-10 flex items-center gap-4 bg-white py-2 px-4 print:hidden"},_e={class:"flex cursor-pointer items-center"},pe={class:"flex cursor-pointer items-center"},me={for:"reading-tools-form-modal",class:"btn-outline btn-xs btn"},fe=t("input",{id:"reading-tools-form-modal",type:"checkbox",class:"modal-toggle"},null,-1),ve={class:"modal"},ge={class:"modal-box relative"},ke=t("label",{for:"reading-tools-form-modal",class:"btn-sm btn-circle btn absolute right-2 top-2"},"✕",-1),he=g({__name:"ReadingTools",setup(n){const s=_(S()),o=_(S()),e=_(!1),a=_(!1);return $(e,()=>{e.value&&(a.value=!1)}),$(a,()=>{a.value&&(e.value=!1)}),(d,l)=>(u(),v(y,null,[t("div",de,[t("label",_e,[R(t("input",{"onUpdate:modelValue":l[0]||(l[0]=c=>e.value=c),type:"checkbox",class:"toggle toggle-sm mr-1"},null,512),[[C,e.value]]),A(" "+i(d.$t("DIALOG_BOX.MASK")),1)]),t("label",pe,[R(t("input",{"onUpdate:modelValue":l[1]||(l[1]=c=>a.value=c),type:"checkbox",class:"toggle toggle-sm mr-1"},null,512),[[C,a.value]]),A(" "+i(d.$t("DIALOG_BOX.RULER")),1)]),t("label",me,i(d.$t("SETTINGS.MY_PREFERENCES")),1),fe,t("div",ve,[t("div",ge,[ke,f(se,{"mask-opacity":s.value.opacity,"onUpdate:mask-opacity":l[2]||(l[2]=c=>s.value.opacity=c),"mask-thickness":s.value.thickness,"onUpdate:mask-thickness":l[3]||(l[3]=c=>s.value.thickness=c),"ruler-opacity":o.value.opacity,"onUpdate:ruler-opacity":l[4]||(l[4]=c=>o.value.opacity=c),"ruler-thickness":o.value.thickness,"onUpdate:ruler-thickness":l[5]||(l[5]=c=>o.value.thickness=c),class:"mt-6"},null,8,["mask-opacity","mask-thickness","ruler-opacity","ruler-thickness"])])]),f(ue,{class:"ml-auto"})]),e.value?(u(),I(re,{key:0,mask:s.value},null,8,["mask"])):k("",!0),a.value?(u(),I(ne,{key:1,ruler:o.value},null,8,["ruler"])):k("",!0)],64))}}),be={key:0,class:"alert relative m-4 block w-auto shadow-lg"},Ae={class:"text-lg font-semibold"},Ie={class:"p-1 text-sm"},Oe={class:"p-1 text-sm"},ye=["href"],Te=g({__name:"FloatingImagesAlert",setup(n){const s=_(!0),o=()=>s.value=!1;return(e,a)=>s.value?(u(),v("div",be,[t("div",{class:"btn-sm btn-circle btn absolute right-2 top-2",onClick:o},"✕"),t("div",Ae,i(e.$t("DIALOG_BOX.FLOATING_IMAGES_TITLE")),1),t("div",Ie,i(e.$t("DIALOG_BOX.FLOATING_IMAGES_EXPLANATION")),1),t("div",Oe,[A(i(e.$t("DIALOG_BOX.FLOATING_IMAGES_LEARN_MORE"))+" ",1),t("a",{class:"link",target:"_blank",href:e.$t("DIALOG_BOX.FLOATING_IMAGES_SUPPORT_LINK")},i(e.$t("DIALOG_BOX.FLOATING_IMAGES_CLICK_HERE")),9,ye)])])):k("",!0)}}),Ee={class:"py-2 px-4"},$e={key:0},Le=g({__name:"AdaptedContentPage",setup(n){const s=_(""),{getActiveProfile:o}=K(),e=p(()=>{var m;return(m=o())==null?void 0:m.settings}),a=_(""),d=_(!1),l=m=>{try{const b=m.message,{html:B,withFloatingImages:E}=JSON.parse(b);a.value=B,d.value=E,console.log("withFloatingImages",E)}catch{s.value="error"}},c=()=>{Office.context.ui.messageParent("ready",{targetOrigin:"*"})},T=m=>{c(),m.status!==Office.AsyncResultStatus.Succeeded&&(s.value=m.error.message)};return O(()=>{Office.onReady(()=>{Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,l,T)})}),(m,b)=>(u(),v(y,null,[f(r(he)),t("div",Ee,[s.value?(u(),v("div",$e,i(s.value),1)):k("",!0),d.value?(u(),I(Te,{key:1})):k("",!0),f(F,{"adapt-html-element-async":r(D)(),settings:r(e),"content-to-adapt":a.value},null,8,["adapt-html-element-async","settings","content-to-adapt"])])],64))}});export{Le as AdaptedContentPage};
