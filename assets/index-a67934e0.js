import{d as g,h as G,o as d,e as _,F as b,r as H,t as i,u as c,i as p,f as t,W as y,l as h,g as m,I as T,k as X,a as f,X as P,Y,Z as Q,w as R,O as C,J as S,$ as L,a0 as x,c as A,a1 as M,C as V}from"./index-41c73986.js";import{t as N,o as U,f as J,_ as z}from"./textAdaptation-4ec32bb6.js";import{_ as I}from"./RangeBar.vue_vue_type_script_setup_true_lang-60b409e1.js";const W=["value"],Z=["value"],j=g({__name:"TextProfileActiveDropdownReadonly",props:{modelValue:null},emits:["update:modelValue"],setup(a,{emit:e}){const{preferences:o}=G(),s=n=>{const{value:u}=n.target;e("update:modelValue",Number(u))};return(n,u)=>(d(),_("select",{value:a.modelValue,class:"select-primary select select-sm",onInput:s},[(d(!0),_(b,null,H(c(o).profiles,({name:r,id:l})=>(d(),_("option",{key:l,value:l},i(r),9,Z))),128))],40,W))}}),q={key:0,class:"alert relative m-4 block w-auto shadow-lg"},ee={class:"text-lg font-semibold"},te={class:"p-1 text-sm"},se={class:"p-1 text-sm"},oe=["href"],ne=g({__name:"FloatingImagesAlert",setup(a){const e=p(!0),o=()=>e.value=!1;return(s,n)=>e.value?(d(),_("div",q,[t("div",{class:"btn-sm btn-circle btn absolute right-2 top-2",onClick:o},"✕"),t("div",ee,i(s.$t("DIALOG_BOX.FLOATING_IMAGES_TITLE")),1),t("div",te,i(s.$t("DIALOG_BOX.FLOATING_IMAGES_EXPLANATION")),1),t("div",se,[y(i(s.$t("DIALOG_BOX.FLOATING_IMAGES_LEARN_MORE"))+" ",1),t("a",{class:"link",target:"_blank",href:s.$t("DIALOG_BOX.FLOATING_IMAGES_SUPPORT_LINK")},i(s.$t("DIALOG_BOX.FLOATING_IMAGES_CLICK_HERE")),9,oe)])])):h("",!0)}}),ae={for:"reading-tools-form-modal",class:"btn-outline btn-xs btn"},le=t("input",{id:"reading-tools-form-modal",type:"checkbox",class:"modal-toggle"},null,-1),re={for:"reading-tools-form-modal",class:"modal cursor-pointer"},ce={class:"modal-box relative",for:""},ie=t("label",{for:"reading-tools-form-modal",class:"btn-sm btn-circle btn absolute right-2 top-2"},"✕",-1),ue={class:"mt-6 rounded-lg border border-base-300"},de={class:"table w-full"},pe={class:"w-40 p-3 font-semibold",rowspan:"2"},_e={class:"p-3"},me={class:"p-3"},fe={class:"p-3"},ve={class:"p-3"},ge={class:"w-40 border-b-0 bg-transparent p-3 font-semibold",rowspan:"2"},he={class:"p-3"},ke={class:"p-3"},be={class:"p-3"},Ie={class:"p-3"},ye=g({__name:"ReadingToolsFormModal",props:{maskThickness:null,maskOpacity:null,rulerThickness:null,rulerOpacity:null},emits:["undefined","update:rulerThickness","update:maskOpacity","update:rulerOpacity"],setup(a,{emit:e}){return(o,s)=>(d(),_(b,null,[t("label",ae,i(o.$t("SETTINGS.MY_PREFERENCES")),1),le,t("label",re,[t("label",ce,[ie,t("div",ue,[t("table",de,[t("tbody",null,[t("tr",null,[t("td",pe,i(o.$t("QUICK_ACTIVATE.SCREEN_MASK")),1),t("td",_e,i(o.$t("QUICK_ACTIVATE.THICKNESS")),1),t("td",me,[m(I,{"model-value":a.maskThickness,options:c(N),"onUpdate:modelValue":s[0]||(s[0]=n=>e("update:maskThickness",n))},null,8,["model-value","options"])])]),t("tr",null,[t("td",fe,i(o.$t("QUICK_ACTIVATE.OPACITY")),1),t("td",ve,[m(I,{"model-value":a.maskOpacity,options:c(U),"onUpdate:modelValue":s[1]||(s[1]=n=>e("update:maskOpacity",n))},null,8,["model-value","options"])])]),t("tr",null,[t("td",ge,i(o.$t("QUICK_ACTIVATE.READING_RULER")),1),t("td",he,i(o.$t("QUICK_ACTIVATE.THICKNESS")),1),t("td",ke,[m(I,{"model-value":a.rulerThickness,options:c(N),"onUpdate:modelValue":s[2]||(s[2]=n=>e("update:rulerThickness",n))},null,8,["model-value","options"])])]),t("tr",null,[t("td",be,i(o.$t("QUICK_ACTIVATE.OPACITY")),1),t("td",Ie,[m(I,{"model-value":a.rulerOpacity,options:c(U),"onUpdate:modelValue":s[3]||(s[3]=n=>e("update:rulerOpacity",n))},null,8,["model-value","options"])])])])])])])])],64))}});function B(){const a=p(0),e=o=>a.value=o.clientY;return T(()=>{document.addEventListener("mousemove",e)}),X(()=>{document.removeEventListener("mousemove",e)}),{clientY:a}}const Oe={class:"ruler__line fixed inset-x-0 top-0 bg-black print:hidden"},Ae=g({__name:"ReadingToolsRuler",props:{ruler:null},setup(a){const e=a;P(r=>({ccf5bf72:c(u),"5c2c2098":c(s),"616b2896":c(n)}));const{clientY:o}=B(),s=f(()=>`${o.value}px`),n=f(()=>"#000000"+e.ruler.opacity),u=f(()=>`${e.ruler.thickness}px`);return console.log(e),(r,l)=>(d(),_("div",Oe))}});const w=(a,e)=>{const o=a.__vccOpts||a;for(const[s,n]of e)o[s]=n;return o},Te=w(Ae,[["__scopeId","data-v-84cc20b2"]]),K=a=>(Y("data-v-f221fa5c"),a=a(),Q(),a),Ee=K(()=>t("div",{class:"mask__top fixed inset-0 print:hidden"},null,-1)),$e=K(()=>t("div",{class:"mask__bottom top-50 fixed inset-0 print:hidden"},null,-1)),Re=g({__name:"ReadingToolsMask",props:{mask:null},setup(a){const e=a;P(l=>({"54458eea":c(o),"09518556":c(r),"5f82e6ce":c(n)}));const o=f(()=>"#000000"+e.mask.opacity),s=f(()=>25*parseInt(e.mask.thickness)),n=f(()=>`${s.value}px`),{clientY:u}=B(),r=f(()=>`${u.value-Math.floor(s.value/2)}px`);return(l,E)=>(d(),_(b,null,[Ee,$e],64))}});const Ce=w(Re,[["__scopeId","data-v-f221fa5c"]]);function Se(){const a=p(!1),e=p(!1);return R(a,()=>{a.value&&(e.value=!1)}),R(e,()=>{e.value&&(a.value=!1)}),{maskEnabled:a,rulerEnabled:e}}const Le={class:"sticky top-0 z-10 flex items-center gap-4 bg-white py-2 px-4 print:hidden"},xe={class:"flex cursor-pointer items-center"},Me={class:"flex cursor-pointer items-center"},Ve=g({__name:"ReadingToolsToolbar",setup(a){const e=p(M()),o=p(M()),{maskEnabled:s,rulerEnabled:n}=Se();return(u,r)=>(d(),_(b,null,[t("div",Le,[C(u.$slots,"before"),t("label",xe,[S(t("input",{"onUpdate:modelValue":r[0]||(r[0]=l=>x(s)?s.value=l:null),type:"checkbox",class:"toggle toggle-sm mr-1"},null,512),[[L,c(s)]]),y(" "+i(u.$t("DIALOG_BOX.MASK")),1)]),t("label",Me,[S(t("input",{"onUpdate:modelValue":r[1]||(r[1]=l=>x(n)?n.value=l:null),type:"checkbox",class:"toggle toggle-sm mr-1"},null,512),[[L,c(n)]]),y(" "+i(u.$t("DIALOG_BOX.RULER")),1)]),m(ye,{"mask-opacity":e.value.opacity,"onUpdate:mask-opacity":r[2]||(r[2]=l=>e.value.opacity=l),"mask-thickness":e.value.thickness,"onUpdate:mask-thickness":r[3]||(r[3]=l=>e.value.thickness=l),"ruler-opacity":o.value.opacity,"onUpdate:ruler-opacity":r[4]||(r[4]=l=>o.value.opacity=l),"ruler-thickness":o.value.thickness,"onUpdate:ruler-thickness":r[5]||(r[5]=l=>o.value.thickness=l)},null,8,["mask-opacity","mask-thickness","ruler-opacity","ruler-thickness"]),C(u.$slots,"after")]),c(s)?(d(),A(Ce,{key:0,mask:e.value},null,8,["mask"])):h("",!0),c(n)?(d(),A(Te,{key:1,ruler:o.value},null,8,["ruler"])):h("",!0)],64))}}),Ne=g({__name:"PrintButton",setup(a){const e=p(),o=f(()=>e.value!==Office.PlatformType.Mac);T(()=>{Office.onReady(n=>{e.value=n.platform})});const s=()=>window.print();return(n,u)=>c(o)?(d(),_("button",{key:0,class:"btn-outline btn-secondary btn-xs btn",onClick:s},i(n.$t("DIALOG_BOX.PRINT")),1)):h("",!0)}}),Ue={class:"py-2 px-4"},Ge={key:0},Ke=g({__name:"AdaptedContentPage",setup(a){const e=p(""),{preferences:o,getProfileById:s}=G(),n=p(o.activeProfileId),u=f(()=>{var v;return(v=s(n.value))==null?void 0:v.settings}),r=p(""),l=p(!1),E=v=>{try{const k=v.message,{html:O,withFloatingImages:$}=JSON.parse(k);r.value=O,l.value=$,console.log("withFloatingImages",$)}catch{e.value="error"}},D=()=>{Office.context.ui.messageParent("ready",{targetOrigin:"*"})},F=v=>{D(),v.status!==Office.AsyncResultStatus.Succeeded&&(e.value=v.error.message)};return T(()=>{Office.onReady(()=>{Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,E,F)})}),(v,k)=>(d(),_(b,null,[m(c(Ve),null,{before:V(()=>[m(c(j),{modelValue:n.value,"onUpdate:modelValue":k[0]||(k[0]=O=>n.value=O),class:"select-secondary w-52"},null,8,["modelValue"]),y(" | ")]),after:V(()=>[m(Ne)]),_:1}),t("div",Ue,[e.value?(d(),_("div",Ge,i(e.value),1)):h("",!0),l.value?(d(),A(ne,{key:1})):h("",!0),m(z,{"adapt-html-element-async":c(J)(),settings:c(u),"content-to-adapt":r.value},null,8,["adapt-html-element-async","settings","content-to-adapt"])])],64))}});export{Ke as AdaptedContentPage};
