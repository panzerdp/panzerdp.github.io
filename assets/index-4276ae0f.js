import{t as p,o as v,f as H,_ as C}from"./textAdaptation-c00b76ca.js";import{d as I,i as t,h as M,a as _,I as E,e as y,t as F,l as N,f as s,g as $,u as h,o as k}from"./index-1865e8c8.js";const z={class:"py-2 px-4"},T={key:0},V={class:"container-fluid"},Y=I({__name:"AdaptedContentPage",setup(i){const a=t(""),n=t(),{getActiveProfile:c}=M(),l=_(()=>{var e;return(e=c())==null?void 0:e.settings}),r=t(),d=t(),f=t(),x=t(),O=t(),u=t(),R=t({enabled:!1,thickness:p[0].value,opacity:v[0].value}),A=t({enabled:!1,thickness:p[0].value,opacity:v[0].value}),g=t(""),P=t(!1),b=e=>{try{const o=e.message,{html:B,withFloatingImages:m}=JSON.parse(o);g.value=B,P.value=m,console.log("withFloatingImages",m)}catch{a.value="error"}},S=()=>{Office.context.ui.messageParent("ready",{targetOrigin:"*"})},Z=e=>{S(),e.status!==Office.AsyncResultStatus.Succeeded&&(a.value=e.error.message)};return E(()=>{Office.onReady(e=>{Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,b,Z),n.value=e.platform}),document.addEventListener("mousemove",e=>{if(d.value){const o=document.body.scrollHeight;d.value.style.height=`${o.toString()}px`}u.value&&e.pageY>u.value.offsetHeight&&(r.value&&R.value.enabled&&(r.value.style.top=`${e.pageY}px`),f.value&&A.value.enabled&&(f.value.style.height=`${e.pageY-u.value.offsetHeight-20}px`))})}),_(()=>n.value!==Office.PlatformType.Mac),(e,o)=>(k(),y("div",z,[a.value?(k(),y("div",T,F(a.value),1)):N("",!0),s("div",V,[$(C,{"adapt-html-element-async":h(H)(),settings:h(l),"content-to-adapt":g.value},null,8,["adapt-html-element-async","settings","content-to-adapt"])]),s("div",{id:"ruler-add-in",ref_key:"ruler",ref:r},null,512),s("div",{id:"mask-add-in",ref_key:"mask",ref:d},[s("div",{id:"before-reading-zone",ref_key:"maskBeforeReadingZone",ref:f},null,512),s("div",{id:"mask-reading-zone",ref_key:"maskReadingZone",ref:x},null,512),s("div",{id:"after-reading-zone",ref_key:"maskAfterReadingZone",ref:O},null,512)],512)]))}});const w=(i,a)=>{const n=i.__vccOpts||i;for(const[c,l]of a)n[c]=l;return n},L=w(Y,[["__scopeId","data-v-b265a52d"]]);export{L as AdaptedContentPage};
